---
import BaseLayout from '@presentation/layouts/BaseLayout.astro';
import Hero from '@presentation/sections/Hero.astro';
import About from '@presentation/sections/About.astro';
import FeaturedProjects from '@presentation/sections/FeaturedProjects.astro';
import Skills from '@presentation/sections/Skills.astro';
import Experience from '@presentation/sections/Experience.astro';
import Contact from '@presentation/sections/Contact.astro';
import type { Language } from '@domain/types/Language';
import { configService } from '@shared/di/container';
import { DEFAULT_SITE_URL } from '@shared/constants';

export const prerender = false;

const urlLang = Astro.url.searchParams.get('lang');
const lang: Language = (urlLang === 'es' || urlLang === 'en') ? urlLang : 'es';

const config = await configService.getConfig();
const siteUrl = import.meta.env.PUBLIC_SITE_URL || DEFAULT_SITE_URL;
const title = `${config.personal.name} - ${config.personal.role}`;
const description = lang === 'es' 
  ? `Portafolio profesional de ${config.personal.name}. ${config.personal.role} especializado en desarrollo Fullstack, microservicios y AWS.`
  : `Professional portfolio of ${config.personal.name}. ${config.personal.role} specialized in Fullstack development, microservices and AWS.`;
---

<BaseLayout title={title} description={description} lang={lang}>
  <Hero lang={lang} />
  <About lang={lang} />
  <FeaturedProjects lang={lang} />
  <Skills lang={lang} />
  <Experience lang={lang} />
  <Contact lang={lang} />
</BaseLayout>

<script type="module" is:inline>
  import { initLanguage } from '@shared/stores/language';
  initLanguage({JSON.stringify(lang)});
</script>
